# 组件使用指南

## 专利表格组件

### 通用专利表格 (PatentTable)
```astro
---
import PatentTable from '../components/PatentTable'
import { loadPatents } from '../lib/data/patents'

const patentsData = await loadPatents()
---

<PatentTable patents={patentsData} />
```

### 发明专利表格 (InventionTable)
```astro
---
import InventionTable from '../components/InventionTable'
import { loadPatents, filterPatentsByType } from '../lib/data/patents'

const allPatents = await loadPatents()
const inventionPatents = filterPatentsByType(allPatents, '发明专利')
---

<InventionTable patents={inventionPatents} />
```

### 软件著作权表格 (SoftwareTable)
```astro
---
import SoftwareTable from '../components/SoftwareTable'
import { loadPatents, filterPatentsByType } from '../lib/data/patents'

const allPatents = await loadPatents()
const softwarePatents = filterPatentsByType(allPatents, '软件著作权')
---

<SoftwareTable patents={softwarePatents} />
```

### Props 说明
| 组件 | 属性 | 类型 | 默认值 | 说明 |
|------|------|------|--------|------|
| `PatentTable` | `patents` | `Patent[]` | 必填 | 专利数据数组 |
| `InventionTable` | `patents` | `Patent[]` | 必填 | 发明专利数据 |
| `SoftwareTable` | `patents` | `Patent[]` | 必填 | 软件著作权数据 |

## 论文卡片组件 (PaperCard)

### 基础用法
```astro
---
import PaperCard from '../components/PaperCard.astro'
import { getCollection } from 'astro:content'

const papers = await getCollection('papers')
---

{papers.map(paper => (
  <PaperCard paper={paper} />
))}
```

### 高级用法
```astro
---
import PaperCard from '../components/PaperCard.astro'
import { getCollection } from 'astro:content'

const papers = await getCollection('papers')
---

<!-- 显示分区标注和作者贡献 -->
<PaperCard 
  paper={paper}
  showPartition={true}
  showContributions={true}
  showAbstract={false}
/>

<!-- 紧凑模式 -->
<PaperCard 
  paper={paper}
  compact={true}
/>
```

### Props 说明
| 属性 | 类型 | 默认值 | 说明 |
|------|------|--------|------|
| `paper` | `CollectionEntry<'papers'>` | 必填 | 论文数据，包含所有Frontmatter字段 |
| `showAbstract` | `boolean` | `false` | 是否显示摘要 |
| `showLink` | `boolean` | `false` | 是否显示链接 |

### 功能特性
- **自动作者标记**：自动识别并标记共同一作（†）、通讯作者（*）和其他贡献标记
- **分区显示**：自动显示期刊分区标签
- **日期格式化**：自动将 `YYYY-MM-DD` 格式化为 `YYYY年MM月`
- **作者悬停提示**：鼠标悬停在作者姓名上显示贡献角色说明
- **响应式设计**：适配不同屏幕尺寸

## 成员卡片组件 (MemberCard)

### 基础用法
```astro
---
import MemberCard from '../components/MemberCard.astro'
import { getCollection } from 'astro:content'

const members = await getCollection('members')
---

{members.map(member => (
  <MemberCard member={member} />
))}
```

### 按组显示
```astro
---
import MemberCard from '../components/MemberCard.astro'
import { getCollection } from 'astro:content'

const members = await getCollection('members')
const professors = members.filter(m => m.data.group === 'Professor')
const phds = members.filter(m => m.data.group === 'PhD')
---

<!-- 教授组 -->
{professors.map(member => (
  <MemberCard member={member} />
))}

<!-- 博士生组 -->
{phds.map(member => (
  <MemberCard member={member} />
))}
```

### Props 说明
| 属性 | 类型 | 默认值 | 说明 |
|------|------|--------|------|
| `member` | `CollectionEntry<'members'>` | 必填 | 成员数据 |

### 功能特性
- **自适应图片**：使用 `AdaptiveImage` 组件显示成员照片
- **外部链接支持**：如果提供 `externalLink`，卡片会变成可点击链接
- **占位图片**：如果没有照片，显示默认占位图片
- **响应式设计**：适配不同屏幕尺寸
- **悬停效果**：鼠标悬停时有阴影和颜色变化效果

## 项目卡片组件 (ProjectCard)

### 基础用法
```astro
---
import ProjectCard from '../components/ProjectCard.astro'
import { loadProjects } from '../lib/data/projects'

const projects = await loadProjects()
---

{projects.map(project => (
  <ProjectCard project={project} />
))}
```

### 按状态筛选
```astro
---
import ProjectCard from '../components/ProjectCard.astro'
import { loadProjects, filterProjectsByStatus } from '../lib/data/projects'

const allProjects = await loadProjects()
const ongoingProjects = filterProjectsByStatus(allProjects, '在研')
const completedProjects = filterProjectsByStatus(allProjects, '已结题')
---

<!-- 在研项目 -->
{ongoingProjects.map(project => (
  <ProjectCard project={project} />
))}

<!-- 已结题项目 -->
{completedProjects.map(project => (
  <ProjectCard project={project} />
))}
```

### Props 说明
| 属性 | 类型 | 默认值 | 说明 |
|------|------|--------|------|
| `project` | `Project` | 必填 | 项目数据 |
| `showStatus` | `boolean` | `true` | 是否显示状态标签 |
| `showLevel` | `boolean` | `true` | 是否显示项目级别 |
| `showPeriod` | `boolean` | `true` | 是否显示项目周期 |

## 时间轴组件 (TimeAxis)

### 基础用法
```astro
---
import TimeAxis from '../components/TimeAxis.astro'
---

<TimeAxis 
  events={[
    { year: '2020', title: '课题组成立', description: 'CVEO课题组正式成立' },
    { year: '2021', title: '首个国家级项目', description: '获得国家自然科学基金项目' },
    { year: '2023', title: '重要成果发表', description: '在顶级期刊发表多篇论文' }
  ]}
/>
```

### Props 说明
| 属性 | 类型 | 默认值 | 说明 |
|------|------|--------|------|
| `events` | `Array<{year: string, title: string, description: string}>` | 必填 | 时间轴事件数组 |
| `showYear` | `boolean` | `true` | 是否显示年份 |
| `showDescription` | `boolean` | `true` | 是否显示描述 |
| `reverse` | `boolean` | `false` | 是否反向显示（从新到旧） |

## 自适应图片组件 (AdaptiveImage)

### 基础用法
```astro
---
import AdaptiveImage from '../components/AdaptiveImage.astro'
---

<AdaptiveImage 
  src="/images/example.jpg"
  alt="示例图片"
  width={600}
  height={400}
/>
```

### Props 说明
| 属性 | 类型 | 默认值 | 说明 |
|------|------|--------|------|
| `src` | `string` | 必填 | 图片路径 |
| `alt` | `string` | 必填 | 替代文本 |
| `width` | `number` | - | 图片宽度 |
| `height` | `number` | - | 图片高度 |
| `className` | `string` | `''` | 自定义 CSS 类名 |
| `lazy` | `boolean` | `true` | 是否启用懒加载 |

## 数据工具函数

### 专利数据
```typescript
import { 
  loadPatents, 
  filterPatentsByType, 
  filterPatentsByStatus,
  filterPatentsByYear,
  sortPatents 
} from '../lib/data/patents'

// 加载所有专利
const patents = await loadPatents()

// 筛选发明专利
const inventionPatents = filterPatentsByType(patents, '发明专利')

// 按日期降序排序
const sortedPatents = sortPatents(patents, 'date-desc')
```

### 新闻数据
```typescript
import { 
  loadNews, 
  getLatestNews, 
  filterNewsByYear,
  formatNewsDate 
} from '../lib/data/news'

// 加载所有新闻
const news = await loadNews()

// 获取最新3条新闻
const latestNews = getLatestNews(news, 3)

// 格式化日期
const formattedDate = formatNewsDate('2023-10-01')
```

### 项目数据
```typescript
import { 
  loadProjects, 
  filterProjectsByStatus 
} from '../lib/data/projects'

// 加载所有项目
const projects = await loadProjects()

// 筛选在研项目
const ongoingProjects = filterProjectsByStatus(projects, '在研')
```

## 工具函数

### 日期格式化
```typescript
import { formatDate, formatNewsDate } from '../lib/utils/format'

// 格式化论文日期
const paperDate = formatDate('2023-10-01') // "2023年10月"

// 格式化新闻日期
const newsDate = formatNewsDate('2023-10-01') // "2023年10月01日"
```

### 文本处理
```typescript
import { generateSlug, truncateText } from '../lib/utils/format'

// 生成URL友好的slug
const slug = generateSlug('示例标题') // "示例标题"

// 截断文本
const truncated = truncateText('很长的一段文本', 10) // "很长的一段文..."
```

## 最佳实践

### 1. 类型安全
- 始终使用 TypeScript 类型定义
- 避免使用 `any` 类型
- 为组件 props 定义明确的接口

### 2. 错误处理
- 使用 try-catch 处理异步操作
- 验证输入数据
- 提供有意义的错误信息

### 3. 性能优化
- 使用懒加载图片
- 按需加载数据
- 避免不必要的重新渲染

### 4. 可访问性
- 为图片提供 alt 文本
- 使用语义化 HTML
- 确保颜色对比度符合标准

### 5. 代码复用
- 提取共享逻辑到工具函数
- 创建可复用的基础组件
- 遵循 DRY 原则