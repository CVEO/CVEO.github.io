# 部署与维护指南

## 代码仓库
- 建议使用 GitHub 组织账号管理代码库
- 主分支 `main` 直接更新

## 依赖安装
- Node.js 20
- 安装依赖：
```
npm install
```

## 本地开发
- 开发服务器：
```
npm run dev
```
- 预览构建产物：
```
npm run preview
```

## 构建与检查
- 构建：
```
npm run build
```
- HTML 校验：
```
npm run check:html
```
- 链接检查：
```
npm run check:links
```
- 组合检查：
```
npm run check
```

## GitHub Pages 自动部署
- 工作流文件：`.github/workflows/deploy.yml`
- 触发条件：推送到 `main`
- 流程：
  - 安装依赖
  - 构建 `dist`
  - 上传 Pages 资源
  - 部署到 GitHub Pages
  - 执行构建检查

## 自定义域名
- 在仓库的 Pages 设置中绑定 com 域名
- 添加 `public/CNAME` 文件，内容为域名
- DNS 配置 A/AAAA 到 GitHub Pages IP 或使用 CNAME 到 `username.github.io`

## 内容更新

### 数据文件更新
- **新闻动态**: 编辑 `src/data/news.md`
- **专利数据**: 编辑 `src/data/patents.json`
- **科研项目**: 编辑 `src/data/projects.json`
- **奖项荣誉**: 编辑 `src/data/awards.json`

### 内容集合更新
- **期刊论文**: 在 `src/content/papers/` 目录下新增或修改 `.md` 文件
- **团队成员**: 在 `src/content/members/` 目录下新增或修改 `.md` 文件

### 页面更新
- **首页**: `src/pages/index.astro`
- **研究方向**: `src/pages/research.astro`
- **科研项目**: `src/pages/research-projects.astro`
- **新闻动态**: `src/pages/news.astro`
- **联系我们**: `src/pages/contact.astro`
- **团队成员**: `src/pages/team/` 目录下的页面

## 开发指南

### 代码质量
- 使用 TypeScript 严格模式
- 运行类型检查：`npx tsc --noEmit`
- 遵循项目代码规范

### 组件开发
- **组件位置**: `src/components/`
- **类型定义**: 所有组件必须使用 TypeScript 类型定义
- **组件分类**:
  - 基础组件：`AdaptiveImage.astro`, `NavBar.astro`, `Footer.astro`
  - 内容展示组件：`PaperCard.astro`, `MemberCard.astro`, `ProjectCard.astro`
  - 数据表格组件：`PatentTable/`, `InventionTable.astro`, `SoftwareTable.astro`
  - 特殊组件：`TimeAxis.astro`
- **开发规范**:
  - 组件 props 必须有明确的接口定义
  - 使用 Astro 组件最佳实践
  - 确保良好的可访问性支持

### 数据管理
- **类型定义**: `src/lib/types/` - 包含所有数据类型的 TypeScript 接口
- **数据工具**: `src/lib/data/` - 数据加载和处理的工具函数
  - `patents.ts` - 专利数据相关函数
  - `projects.ts` - 项目数据相关函数
  - `news.ts` - 新闻数据相关函数
- **工具函数**: `src/lib/utils/` - 通用工具函数
  - `format.ts` - 日期和文本格式化函数
- **数据验证**: 所有 JSON 数据必须通过验证函数加载，确保数据完整性

### 类型安全
- 所有组件 props 必须有 TypeScript 接口
- 使用严格类型检查
- 避免使用 `any` 类型

## 维护建议

### 定期检查
- 每次内容更新后运行 `npm run check`
- 定期检查外链有效性：`npm run check:links`
- 定期运行类型检查：`npx tsc --noEmit`
- 检查 HTML 规范：`npm run check:html`

### 内容维护
- **照片规范**: 统一尺寸（建议 600×800 像素），浅色背景
- **数据一致性**: 确保 JSON 数据格式正确
- **链接更新**: 定期更新论文链接和外部资源链接

### 性能优化
- 图片使用 `AdaptiveImage` 组件确保懒加载
- 定期清理未使用的依赖
- 监控构建产物大小

### 脚本工具
- **链接检查**: `scripts/link-check.js` - 检查构建产物中的死链
- **论文生成**: `scripts/generate-papers.js` - 从文本格式生成论文 Markdown 文件
- **使用方式**:
  ```bash
  # 检查链接
  node scripts/link-check.js
  
  # 生成论文文件（需要配置输入文件）
  node scripts/generate-papers.js
  ```

### 安全维护
- 定期更新依赖包：`npm update`
- 检查安全漏洞：`npm audit`
- 确保所有外部链接使用 HTTPS
